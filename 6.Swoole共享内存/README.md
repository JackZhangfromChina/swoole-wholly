# Swoole 共享内存

## 共享内存 Table（table.php）

Swoole\Table

```
Table 是一个基于共享内存和锁实现的超高性能，并发数据结构。用于解决多进程/多线程数据共享和同步加锁问题。特点如下：

性能高；
内置行锁，非全局锁；
多线程/多进程安全；
可用于多进程间共享数据；
实现了迭代器和 Coutable 接口，可遍历和使用 count 计算行数。
```

创建内存表(1)

```
Table->construct(int $size, float $conflict_proportion = 0.2)

$size 参数指定表格的最大行数，如果 $size 不是为 2 的 N 次方，底层会自动调整为接近的一个数字，
小于 1024 则默认成 1024，最小值是 1024。

Table 占用内存总数 = ( 结构体长度 + key长度64字节 + 行尺寸 ) * 1.2 (预留的 20% 作为 hash 冲突) * 列尺寸，
如果机器内存不足会创建失败。

(set 操作)能存储的最大行数与 $size 正相关，但不完全一致，实际小于 $size。
```

创建内存表(2)

```
Table->create(): bool

定义好表的结构后，执行 create 向操作系统申请内存，创建表。
    调用 create 前 **不能** 使用 set/get 等数据读写操作方法。
    调用 create 后 **不能** 使用 column 方法添加新字段
